---
title: "Streaming in Agent Networks | Network Documentation | Mastra"
description: Learn how to use streaming in Mastra agent networks to get real-time updates during network execution and create responsive, interactive applications.
---

# Streaming in Agent Networks

Streaming in Agent Networks allows you to receive real-time updates during network execution, rather than waiting for the entire process to complete. This is particularly useful for long-running tasks, interactive applications, and providing users with immediate feedback.

## 1. Streaming Basics

Instead of using the `generate` method, use the `stream` method to get real-time updates:

```ts showLineNumbers copy
import { AgentNetwork } from "@mastra/core/network";

// Create your network
const network = new AgentNetwork({
  name: "Streaming Network",
  agents: [agentA, agentB],
  router: async ({ callCount }) => {
    if (callCount === 0) return agentA;
    if (callCount === 1) return agentB;
    return undefined;
  },
});

// Stream the network execution
const streamResult = await network.stream("Research quantum computing");

// Process the stream
for await (const chunk of streamResult.stream) {
  // Handle different types of events
  switch (chunk.type) {
    case "agentChunk":
      // Incremental output from an agent
      process.stdout.write(chunk.chunk);
      break;
    case "stepStart":
      console.log(`\nStarting step ${chunk.step} with ${chunk.agent}`);
      break;
    case "stepFinish":
      console.log(`\nFinished step ${chunk.result.step} with ${chunk.result.agent}`);
      break;
    case "complete":
      console.log(`\nNetwork execution complete with ${chunk.steps} steps`);
      break;
    case "error":
      console.error(`\nError in ${chunk.agent}: ${chunk.error}`);
      break;
  }
}

// Get the final result
const finalResult = await streamResult.done();
console.log(`\nFinal result: ${finalResult}`);
```

## 2. Stream Event Types

The stream emits various event types:

### `stepStart`

Emitted when a new agent step begins:

```ts copy
{
  type: "stepStart",
  agent: "ResearchAgent", // Name of the agent
  step: 0, // Step number (0-indexed)
}
```

### `agentChunk`

Emitted when an agent produces incremental output:

```ts copy
{
  type: "agentChunk",
  agent: "ResearchAgent", // Name of the agent
  chunk: "quantum", // Text chunk from the agent
  step: 0, // Step number
}
```

### `stepFinish`

Emitted when an agent step completes:

```ts copy
{
  type: "stepFinish",
  result: {
    agent: "ResearchAgent", // Name of the agent
    input: "Research quantum computing", // Input to the agent
    output: "Quantum computing is...", // Complete output from the agent
    timestamp: "2025-03-03T20:30:45.123Z", // When the step finished
    step: 0, // Step number
    state: { /* Current network state */ }
  }
}
```

### `complete`

Emitted when the entire network execution completes:

```ts copy
{
  type: "complete",
  text: "Final summary of quantum computing...", // Final output
  steps: 2, // Total number of steps
  history: [ /* Array of step results */ ]
}
```

### `error`

Emitted when an error occurs:

```ts copy
{
  type: "error",
  agent: "ResearchAgent", // Name of the agent where the error occurred
  error: "Error message", // Error message
  step: 0, // Step number
}
```

### `warning`

Emitted when a warning occurs (e.g., reaching max steps):

```ts copy
{
  type: "warning",
  message: "Network reached maximum steps (5)"
}
```

## 3. Streaming Callbacks

You can also provide callback functions to handle events:

```ts showLineNumbers copy
const streamResult = await network.stream("Research quantum computing", {
  // Called when a step starts
  onStepStart: (agent, step) => {
    console.log(`Starting step ${step} with ${agent.name}`);
  },
  
  // Called when a step finishes
  onStepFinish: (result) => {
    console.log(`Finished step ${result.step} with ${result.agent}`);
    console.log(`Output: ${result.output}`);
  },
  
  // Called when the entire network execution completes
  onFinish: (result) => {
    console.log(`Network execution complete with ${result.steps} steps`);
    console.log(`Final output: ${result.output}`);
  },
});
```

## Next Steps

- Learn about [Custom Routing](./01-custom-routing.mdx) for advanced routing strategies
- Explore [State Management](./02-state-management.mdx) to share data between agents
- Return to the [Overview](./00-overview.mdx) for general network concepts
